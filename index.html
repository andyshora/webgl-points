<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>**** WebGL Points</title>
  <meta name="description" content="{{description}}">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="app/bower_components/jquery/dist/jquery.min.js"></script>
  <script src="app/bower_components/three.js/three.js"></script>
  <script src="app/bower_components/klass/klass.min.js"></script>
  <script src="app/bower_components/three.js-controls/src/OrbitControls.js"></script>
  <script src="app/bower_components/underscore/underscore-min.js"></script>

  <script type="x-shader/x-vertex" id="vertexshader">

      attribute float alpha;
      attribute float pointSize;
      attribute vec3 customColor;

      varying float vAlpha;
      varying float vSize;
      varying vec3 vColor;

      void main() {

        vAlpha = alpha;
        vColor = customColor;
        vSize = pointSize;

        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        gl_PointSize = pointSize;

        gl_Position = projectionMatrix * mvPosition;

      }

  </script>

  <script type="x-shader/x-fragment" id="fragmentshader">

      uniform vec3 color;
      uniform sampler2D pointTexture;
      uniform float worldSize;

      varying float vAlpha;
      varying float vSize;
      varying vec3 vColor;

      void main() {

        vec4 outColor = texture2D( pointTexture, gl_PointCoord );
        gl_FragColor = outColor * vec4( color * vColor.xyz, vAlpha );

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        const vec3 fogColor = vec3( 0.1 );

        float fogFactor = smoothstep( worldSize * 0.75, worldSize * 4.0, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

      }

  </script>
  <link rel="stylesheet" href="app/css/main.css">
</head>
<body>
  <div id="WebGLCanvas"></div>

  <div class="controls-help">
    <div class="controls-trigger">Controls Help</div>
    <ul>
      <li><strong>Orbit</strong> - left mouse / touch: one finger move</li>
      <li><strong>Zoom</strong> - middle mouse, or mousewheel / touch: two finger spread or squish</li>
      <li><strong>Pan</strong> - right mouse, or arrow keys / touch: three finter swipe</li>
    </ul>
  </div>

  <script src="app/js/shims.js"></script>
  <script src="app/js/stats.js"></script>
  <script src="app/js/detector.js"></script>
  <script src="app/js/lib/World.js"></script>
  <script src="app/js/ui.js"></script>

</body>
</html>
